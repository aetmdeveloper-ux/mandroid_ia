async function sendMessage() {
  const inputEl = document.getElementById('user-input');
  const msg = inputEl.value.trim();
  if (!msg) return;

  appendMessage('user', msg);
  inputEl.value = '';
  showTyping();

  try {
    const res = await fetch('/api/chat', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ message: msg })
    });

    const data = await res.json();
    hideTyping();

    if (data.success) {
      appendMessage('ai', data.message);
    } else {
      // MANTENDO A IDENTIDADE DO MANDROID.IA
      appendMessage('ai', "⚠ Erro nos circuitos centrais: " + (data.error || "O terminal não respondeu."));
    }
  } catch (err) {
    hideTyping();
    appendMessage('ai', "⚠ Falha de conexão neural com o servidor MANDROID.");
  }
}

// O restante das funções (appendMessage, showTyping, etc) continua igual abaixo...
